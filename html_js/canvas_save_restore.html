<!DOCTYPE HTML>
<html>
<head>
    <title>Save and restore canvas context</title>
</head>
<body>
    <div>Click "save and draw" 1 time, and then click "restore and draw" 3 times</div>
    <canvas id="canvas" width="280" height="140" style="background-color: rgb(222, 222, 222)">
        Your browser does not support canvas.
    </canvas>
    <br />
    <button type="button" onclick="drawIt();">save and draw</button>
    <button type="button" onclick="restoreIt();">restore and draw</button>

    <script type="text/javascript">

        var ctx = document.getElementById('canvas').getContext('2d');

        /*
         * save() - push canvas context to stack
         * restore() - pop a canvas context from stack
         */

        function drawIt() {
            clearIt();

            ctx.strokeStyle = "red";
            ctx.fillStyle = "green";
            ctx.lineWidth = 5;
            ctx.save(); // push to stack #1

            drawRect1();

            ctx.strokeStyle = "blue";
            ctx.fillStyle = "yellow";
            ctx.lineWidth = 10;
            ctx.save(); // push to stack #2

            drawRect2();
        }

        function restoreIt() {
            clearIt();

            ctx.restore(); // pop canvas context. first we got #2, and then #1

            drawRect1();
            drawRect2();
        }

        function drawRect1() {
            ctx.beginPath();
            ctx.rect(20, 20, 100, 100);
            ctx.stroke();
            ctx.fill();
        }

        function drawRect2() {
            ctx.beginPath();
            ctx.rect(140, 20, 100, 100);
            ctx.stroke();
            ctx.fill();
        }

        function clearIt() {
            ctx.clearRect(0, 0, 280, 140);

            ctx.strokeStyle = "black";
            ctx.fillStyle = "gray";
            ctx.lineWidth = 20;
        }
    </script>
</body>
</html>